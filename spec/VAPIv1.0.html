<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>Vehicle API version 1.0 (VAPIv1.0)</title>
    <script src='https://www.w3.org/Tools/respec/respec-w3c' class='remove' defer></script>
    <script class='remove'>
      var respecConfig = {
        latestVersion: null,
        github: "https://github.com/UlfBj/vehicle-api",
        specStatus: "base",
        editors: [{
          name: "Ulf Bjorkengren",
          company: "Ford Motor Company",
          companyURL: "https://www.ford.com",
        }],
        edDraftURI: "https://github.com/UlfBj/vehicle-api/tree/main/spec/VAPIv1.0.html",
        shortName: "vapi1.0",
        localBiblio: {
          "VISS": {
            title: "COVESA VISS version 3.0",
            href: "https://raw.githack.com/COVESA/vehicle-information-service-specification/releases/tag/v3.0",
            publisher: "Ulf Bjorkengren; Wonsuk Lee"
          }
        }
      };
    </script>
    <style>
      table.parameters, table.exceptions {
          border-spacing: 0;
          border-collapse:    collapse;
          margin: 0.5em 0;
          width:  100%;
      }
      table.parameters { border-bottom:  1px solid #90b8de; }
      table.exceptions { border-bottom:  1px solid #deb890; }

      .parameters th, .exceptions th {
          color:  inherit;
          padding:    3px 5px;
          text-align: left;
          font-weight:    normal;
      }
      .parameters th { color: #fff; background: #005a9c; }
      .exceptions th { background: #deb890; }

      .parameters td, .exceptions td {
          padding:    3px 10px;
          border-top: 1px solid #ddd;
          vertical-align: top;
      }

      .parameters tr:first-child td, .exceptions tr:first-child td {
          border-top: none;
      }

      .parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
          width:  100px;
      }

      .parameters td.prmType {
          width:  120px;
      }

      table.exceptions table {
          border-spacing: 0;
          border-collapse:    collapse;
          width:  100%;
      }

      .simple {
        width:100%;
      }

      thead th{
        border-bottom: 1px solid black;
      }

      .simple tbody th{
        width:33%;
        background: white;
        color: black;        
      }
      pre { white-space: pre-wrap;}
  </style>    
  </head>
  <body>
    <section id='abstract'>
      <p>
        The Vehicle API (VAPI) specification defines an interface for access to vehicle data and services.
        This access is realized by exposing a procedure-based interface to clients of it.
        For vehicle services there i a one-to-one mapping between a service and a procedure.
        For data there are a set of reserved procedure signatures that are used to realize the data access.
        This specification is agnostic to the connectivity solution that is used in implementations of it.
        A client may be deployed in-vehicle, but may also be deployed off-vehicle.
        These details are abstracted in the interface and dealt with in the implementation of the interface.
      </p>
    </section>

    <section id="introduction">
      <h2>Introduction</h2>
      <p>
      This specification defines an interface for access to access to vehicle data based both on a signal based abstraction model and a service based abstraction model.
      </p>
    </section>

    <section id="conformance"></section>

    <section id="terminology">
      <h2>Terminology</h2>
      <p>
      The acronym 'VAPIv1.0' is used to refer to this document, the VAPI version 1.0 specification.<br>
      The acronym 'VSS' is used to refer to the <a href="https://github.com/COVESA/vehicle_signal_specification">'Vehicle Signal Specification'</a>
      which is hosted by COVESA.<br>
      The acronym 'HIM' is used to refer to the <a href="https://github.com/COVESA/hierarchical_information_model">'Hierarchical Information Specification'</a>
      which is hosted by COVESA.<br>
      The acronym 'VISS' is used to refer to the <a href="https://github.com/COVESA/vehicle-information-service-specification">'Vehicle Information Service Specification'</a>
      which is hosted by COVESA.<br>
      The acronym 'CVIS' is used to refer to the <a href="https://github.com/COVESA/commercial-vehicle-information-specifications">
      'Commercial Vehicle Information Specifications'</a> which is hosted by COVESA.
      </p>
    </section>

    <section id="vapi-overview">
      <h2>VAPI Overview</h2>

      <section id="deployment-scenarios">
        <h2>VAPI Deployment Scenarios</h2>
        The software components (SwC) and their possible deployments that are involved in the VAPI context are:
        <ul>
          <li>
          Client: On or off vehicle deployment
          </li>
          <li>
          Vehicle server: On vehicle deployment
          </li>
          <li>
          Signal endpoint: On vehicle deployment
          </li>
          <li>
          Service end point: On or off vehicle deployment
          </li>
          <li>
          VAPI front-end lib: Deployed so as to enable statical/dynamical linking with a Client.
          </li>
        </ul>
        Two interface specifications are used in this context:
        <ul>
          <li>
          VAPI: The interface specification exposed to the client, defined in this document.
          </li>
          <li>
          Vehicle connectivity specification (VCS): This the specification that defines an
          interface that supports communication between remote end points over a TCP/IP-based network.
          </li>
        </ul>
        The VCS is not explicitly exposed to the client, VAPI abstracts its details and thus enables different VCS solutions to be used in implementations of VAPI.
        The VCS can be an OEM proprietary specification, or it can be an open specification like e. g. [[VISS]].<br>
        The main deployment combinations of interest in a VAPI context for the two abstraction models are described below.

        <section id="vapi-signal-deployment">
          <h2>Deployment in a signal based abstraction model</h2>
          The figure below shows a typical deployment architecture and messaging flow for client access of vehicle signals.
        <figure id="fig-signal-deployment">
          <img src="../images/vapi-architecture-base-signals.jpg" alt="VAPI signal based deployment.">
          <figcaption> <span class="fig-title">VAPI signal based deployment.</span></figcaption>
        </figure>
        The signal endpoint, which typically is in a vehicle transducer, is deployed on the southbound side of the vehicle server.<br>
        The VCS scope can be limited to support vehicle signals.
        </section>

        <section id="vapi-service-deployment">
          <h2>Deployment in a service based abstraction model</h2>
A service based abstraction model makes the deployment scenario more complex as the service endpoint can be deployed either at the client side or at the server side.

A service endpoint implements the actions that the service performs. These actions typically involve accessing vehicle signals, which can be done either through vehicle native interfaces or through a VCS exposed by a signal based server.

          <section id="vapi-clientside-deployment">
            <h2>Client side service deployment</h2>
With the service endpoint deployed at the client side the VCS scope can be limited to support vehicle signals.
        <figure id="fig-clientside-deployment">
          <img src="../images/vapi-architecture-local-endpoint.jpg" alt="VAPI client side service based deployment.">
          <figcaption> <span class="fig-title">VAPI client side service based deployment.</span></figcaption>
        </figure>
Client side service deployments do not readily support implementation of a global arbitration of client access to services as one VAPI front-end implementation may not be shared by all clients. This may limit the usefulness of this type of deployment, but it may also be possible to mitigate by adding that functionality on top of all clients. VAPI does not include that functionality.
          </section>

          <section id="vapi-serverside-deployment">
            <h2>Server side service deployment</h2>
With the service endpoint deployed at the server side the VCS scope must include support for services.
        <figure id="fig-serverside-deployment">
          <img src="../images/vapi-architecture-remote-endpoint.jpg" alt="VAPI server side service based deployment.">
          <figcaption> <span class="fig-title">VAPI server side service based deployment.</span></figcaption>
        </figure>
It may also support vehicle signal access, allowing a combination of client side and server side service deployments.

It could then also be used by service end points to access vehicle signals, if a vehicle server that implements it is also deployed.          </section>
        </section>

      </section>
    </section>

    <section id="vapi-procedure-grouping">
      <h2>VAPI Procedure Grouping</h2>
      <p>
        VAPI procedures are characterized as belonging to one of the groups Common, Data, or Service.
      <ul>
          <li>
            The Common group contains the procedures that common to both data and service access.
          </li>
          <li>
            The Data group contains the procedures that a client may use for access to vehicle signals.
            The term vehicle signal is an automotive legacy term having the same meaning as vehicle data.
            The two terms are both used in this specification, denoting the same thing.
          </li>
          <li>
            The Service group contains the procedures that a client may use for access to vehicle services.
          </li>
      </ul>
      <strong>Procedure characteristics:</strong>
      <ul>
        <li>
        Procedures that are invoked to a specific vehicle must include a vehicle ID as input parameter.
        </li>
        <li>
        Procedures representing services with an extended execution time shall include a pointer to a callback procedure as input parameter.
        The procedure implementation must invoke the callback procedure at the successful termination of the service, or if the service terminates unsuccessfully.
        It may issue further callback invokations during the execution.
        A client that does not want to receive callbacks shall set the input callback pointer to nil.
        </li>
        <li>
        The output data that is defined in the procedure signature must contain a ProcedureStatus parameter and an ErrorData parameter.<br>
        If the ProcedureStatus parameter is set to indicate unsuccessful execution then the ErrorData must be populated with information about the failure,
        else the poiner to it shall be set to nil.<br>
        The output data may include service specific parameters.<br>
        If the service does not terminate successfully then all service specific output parameters are invalid.<br>
        The output data shall be returned synchronously with the call of the service.
        Any asynchronous event messages shall use the same output data structure.<br>
        The output data shall be contained in a single struct.
        </li>
        <li>
        Procedures with an extended execution time must return a unique reference to the execution session.
        A client may use this reference to asynchronously terminate the ongoing execution.
        </li>
        <li>
        Procedures that change the state of the vehicle can typically not be executed in multiple parallelly executing instances,
        while the opposite is typically true for procedures that do not change the state of the vehicle.<br>
        Procedures that do not support multiple execution instances must set the Status to ONGOING in the output if it is called
        during execution of a previous call.<br>
        It shall be stated in the procedure documentation if it supports multiple execution instances.
        If not stated then it shall not support multiple execution instances.
        </li>
        <li>
        Procedures calls are agnostic to which transport protocol that is used.
        If a session-based protocol is used then a successful <a href="#connect-procedure">Connect</a> call must have preceeded this call.
        </li>
        <li>
        Service group procedures that are called with a defined callback may be implemented to automatically terminate the callback session when
        the service is successfully terminated, or if an error occurs. If they do not implement such a behavior it is the responsibility of the caller
        to handle the callback session termination by calling the <a href="#cancel-service-procedure">CancelService</a> procedure.
        The service documentation shall describe how it handles callback sessions.
        </li>
      </ul>
      </p>
    </section>

    <section id="common-procedures">
      <h2>Common Procedures</h2>
      <p>
      The common procedures are used for common tasks that are not related specifically to either the data or the service groups.
      </p>

      <section id="getvehicle-procedure">
        <h2>GetVehicle</h2>
        <p>Provides a vehicle reference and connectivity info for a specified vehicle.</p>

        <p>
        This procedure tries to retrieve connectivity data for the vehicle that is associated with the input vehicle globally unique identity.
        This identity may be a pseudo-VIN that has been derived from the vehicle VIN.
        How the client has obtained this identity is out-of-scope for this specification.
        If it succeeds it will return a vehicle Id that shall be used as input in the procedures that require a vehicle Id,
        and data about which protocols that are available for connecting to it.
        </p>

        <section id="getvehicle-signature">
          <h2>Signature</h2>
          <pre><code>GetVehicle(vehicleGuid: string): GetVehicleOutput</code></pre>
        </section>

        <section id="getvehicle-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleGuid</strong> (<span class="type">string</span>)
              <br>
              A globally unique reference to the vehicle.
            </li>
          </ul>
        </section>

        <section id="getvehicle-returns">
          <h2>Returns</h2>
            <span class="type"><code>GetVehicleOutput</code></span>
            <br>
            A struct containing the output data from the GetVehicle procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              VehicleId: uint32,
              Protocol: string[]
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            VehicleId: The reference to the vehicle that shall be used as input in procedures that require a vehicle id.
            The scope of this Id is limited to run-time scope of the client calling GetVehicle.<br>
            <a href="#supported-protocol">Protocol: </a>A list of supported protocols.
        </section>

        <section id="getvehicle-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall at least support the error cases:
            <ul>
              <li>
              Unknown globally unique vehicle identity.
              </li>
              <li>
              Vehicle connection data not available.
              </li>
              <li>
              Connecting to vehicle failed.
              </li>
            </ul>
            </li>
            <li>
             The VehicleId and Protocol parameters are invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="release-vehicle-procedure">
        <h2>ReleaseVehicle</h2>
        <p>Disconnects communication setup with a vehicle.</p>

        <p>
        This procedure terminates a vehicle communication session for all protocols.
        </p>

        <section id="release-vehicle-signature">
          <h2>Signature</h2>
          <pre><code>ReleaseVehicle(vehicleId: uint32): GeneralOutput</code></pre>
        </section>

        <section id="release-vehicle-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
          </ul>
        </section>

        <section id="release-vehicle-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the ReleaseVehicle procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>
      </section>

      <section id="connect-procedure">
        <h2>Connect</h2>
        <p>Sets up a connectivity session with a vehicle.</p>

        <p>
        This procedure sets up a connection with the vehicle over the specified protocol.
        It must be called for any session-based protocol before invoking any service over it.
        </p>

        <section id="connect-signature">
          <h2>Signature</h2>
          <pre><code>Connect(vehicleId: uint32, protocol: string, clientCredentials: string): ConnectOutput</code></pre>
        </section>

        <section id="connect-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>protocol</strong> (<span class="type">string</span>)
              <br>
              If the connectivity solution that is used by the VAPI implementation supports use of multiple transport
              protocols then this parameter allows the client to select which to use.
              The names representing the supported protocols must align with the names used by the implemented connectivity solution.
            </li>
            <li>
              <strong>clientCredentials</strong> (<span class="type">string</span>)
              <br>
              Access to the vehicle services or data might require that a credential is present, e .g. a certificate.
              How the client obtains this credential is out-of-scope for this specification,
              as well as what is required of it to become verified successfully.
              This information may be available in the context of the implemented connectivity solution.
              If it is not required then it shall be set to an empty string.
            </li>
          </ul>
        </section>

        <section id="connect-returns">
          <h2>Returns</h2>
            <span class="type"><code>ConnectOutput</code></span>
            <br>
            A struct containing the output data from the Connect procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              LtCredential: string
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            LtCredential: Long term credentials that may have a lifetime equal to the vehicle connectivity session.
            If not used then it is set to an empty string.
        </section>

        <section id="connect-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall at least support the error cases:
            <ul>
              <li>
              Unknown globally unique vehicle identity.
              </li>
              <li>
              Vehicle connection data not available.
              </li>
              <li>
              Connecting to vehicle failed.
              </li>
            </ul>
            </li>
            <li>
             The LtCredential parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="disconnect-procedure">
        <h2>Disconnect</h2>
        <p>Disconnects a vehicle communication session.</p>

        <p>
        This procedure terminates a vehicle communication session for a specified protocol.
        If communication sessions over other protocols are ongoing, these are unaffected by the call.
        </p>

        <section id="disconnect-signature">
          <h2>Signature</h2>
          <pre><code>Disconnect(vehicleId: uint32, protocol: string): GeneralOutput</code></pre>
        </section>

        <section id="disconnect-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>protocol</strong> (<span class="type">string</span>)
              <br>
              The protocol name of an ongoing communication session.
            </li>
          </ul>
        </section>

        <section id="disconnect-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the Disconnect procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>
      </section>

      <section id="select-protocol-procedure">
        <h2>SelectProtocol</h2>
        <p>Selects the default protocol.</p>

        <p>
        This procedure selects which protocol that shall be the default protocol,
        i. e. the protocol that VAPI procedures that involve sending requests to the vehicle will then use.
        A successful <a href="#connect-procedure">Connect</a> call for the protocol must have preceeded the SelectProtocol call.
        </p>

        <section id="select-protocol-signature">
          <h2>Signature</h2>
          <pre><code>SelectProtocol(vehicleId: uint32, protocol: string): GeneralOutput</code></pre>
        </section>

        <section id="select-protocol-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>protocol</strong> (<span class="type">string</span>)
              <br>
              The protocol name. This was typically obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a> call.
            </li>
          </ul>
        </section>

        <section id="select-protocol-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the SelectProtocol procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>
      </section>

      <section id="cancel-service-procedure">
        <h2>CancelService</h2>
        <p>Cancels an ongoing service.</p>

        <p>
        This procedure terminates an ongoing service call associated with the provided serviceId.
        The service is terminated successfully in its current state, unless the underlying vehicle system responds to this state as an error.
        </p>

        <section id="cancel-service-signature">
          <h2>Signature</h2>
          <pre><code>CancelService(vehicleId: uint32, serviceId: uint23): GeneralOutput</code></pre>
        </section>

        <section id="cancel-service-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a> call.
            </li>
            <li>
              <strong>serviceId</strong> (<span class="type">uint32</span>)
              <br>
              The serviceId was received in a previous response from a service call.
            </li>
          </ul>
        </section>

        <section id="cancel-service-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the CancelService procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>
      </section>

      <section id="service-inquiry-procedure">
        <h2>ServiceInquiry</h2>
        <p>Inquiry to a vehicle about auxillary services that it supports.</p>

        <p>
        This procedure inquires a vehicle about any auxillary services that it supports.
        These services can then be called by calling the <a href="#invoke-procedure">Invoke</a> procedure.
        </p>

        <section id="service-inquiry-signature">
          <h2>Signature</h2>
          <pre><code>ServiceInquiry(vehicleId: uint32): ServiceInquiryOutput</code></pre>
        </section>

        <section id="service-inquiry-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
          </ul>
        </section>

        <section id="service-inquiry-returns">
          <h2>Returns</h2>
            <span class="type"><code>ServiceInquiryOutput</code></span>
            <br>
            A struct containing the output data from the ServiceInquiry procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Service: ServiceSignature[]
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#service-signature">Service: </a>An array of structs describing the service signature.
        </section>

        <section id="service-inquiry-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall at least support the error cases:
            <ul>
              <li>
              Unknown globally unique vehicle identity.
              </li>
              <li>
              Vehicle connection data not available.
              </li>
              <li>
              Connecting to vehicle failed.
              </li>
            </ul>
            </li>
            <li>
             The Service parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="get-st-credentials-procedure">
        <h2>GetStCredentials</h2>
        <p>Get the vehicle short term credentials.</p>

        <p>
        This procedure is used by the client to obtain the short term credentials that can be used to access vehicle signals/services for a specific
        use case / purpose.
        </p>

        <section id="get-st-credentials-signature">
          <h2>Signature</h2>
          <pre><code>GetStCredentials(vehicleId: uint32, ltCredentials: string, purpose: string): GetStCredentialsOutput</code></pre>
        </section>

        <section id="get-st-credentials-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>LtCredential</strong> (<span class="type">string</span>)
              <br>
              The long term credentials that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
              If it is not required then it shall be set to an empty string.
            </li>
            <li>
              <strong>purpose</strong> (<span class="type">string</span>)
              <br>
              A description of the use case / purpose for the client access to the signals/service.
              If not required it shall be set to an empty string.
              The string representing the purpose must align with the purposes supported by the ecosystem around the implemented connectivity solution.
            </li>
          </ul>
        </section>

        <section id="get-st-credentials-returns">
          <h2>Returns</h2>
            <span class="type"><code>GetStCredentialsOutput</code></span>
            <br>
            A struct containing the output data from the GetStCredentials procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              StCredentials: string
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            StCredentials: Short term credentials that have a lifetime  less than or equal to the vehicle connectivity session.
            If not required for the client to get access then it shall be set to an empty string.
        </section>

        <section id="get-st-credentials-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall at least support the error cases:
            <ul>
              <li>
              Unknown globally unique vehicle identity.
              </li>
              <li>
              Vehicle connection data not available.
              </li>
              <li>
              Connecting to vehicle failed.
              </li>
            </ul>
            </li>
            <li>
             The StCredentials parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="invoke-procedure">
        <h2>Invoke</h2>
        <p>The Invoke procedure is used to call auxillary services that are not part of the VAPI specification.</p>

        <p>
        If a service that is not part of the VAPI specification has been installed in the vehicle then information about it shall be
        accessible to the client by calling either the <a href="#service-inquiry-procedure">ServiceInquiry</a>
        or the <a href="#getmetadata-procedure">GetMetadata</a> procedure.
        </p>

        <section id="invoke-signature">
          <h2>Signature</h2>
          <pre><code>Invoke(vehicleId: uint32, serviceName: string, procedureInput: string, stCredentials: string, callback: *fcn(InvokeOutput): InvokeOutput</code></pre>
        </section>

        <section id="Invoke-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>serviceName</strong> (<span class="type">string</span>)
              <br>
            </li>
            The name of the auxillary service.
            <li>
              <strong>procedureInput</strong> (<span class="type">string</span>)
              <br>
              The input parameters of the service to be called are supplied as a JSON object.
              The syntax shall be as follows with both parameter names and values represented as strings (two input parameters in the example).
            <pre><code>
              {
                  "parameterName1": "value1",
                  "parameterName2": "value2"
              }          
              </code></pre>
              An empty string represents the case with a service having no input parameters.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
            <li>
              <strong>callback</strong> (<span class="type">*fcn(InvokeOutput)</span>)
              <br>
              A pointer to a callback function that is called if an event message gets issued by the service.
              If set to nil callbacks will not be issued.
            </li>
          </ul>
        </section>

        <section id="invoke-returns">
          <h2>Returns</h2>
            <span class="type"><code>InvokeOutput</code></span>
            <br>
            A struct containing the output data from the Invoke procedure.
            This shall be returned both synchronously on the procedure call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              ServiceOutput: string,
              ServiceId: uint32
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            ServiceOutput: The service output parameters is a JSON object following the same syntax as used for the input parameters.<br>
            ServiceId: A reference to the service session that the client may use to call <a href="#cancel-service-procedure">CancelService</a>.
            It may be set to zero in which case it is invalid.
        </section>

        <section id="invoke-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The ServiceOutput and ServiceId parameters are invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="getmetadata-procedure">
        <h2>GetMetadata</h2>
        <p>GetMetadata is used to get the metadata that defines a signal or service.</p>

        <p>
        GetMetadata retrieves the metadata from the subtree with the root node that the input path points to.
        The subtree can contain either signal metadata or service metadata.
        </p>

        <section id="getmetadata-signature">
          <h2>Signature</h2>
          <pre><code>GetMetadata(vehicleId: uint32, path: string, stCredentials: string): GetMetadataOutput</code></pre>
        </section>

        <section id="getmetadata-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>path</strong> (<span class="type">string</span>)
              <br>
              The path must follow the syntax described in HIM. It may address any node in the HIM defined tree.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
          </ul>
        </section>

        <section id="getmetadata-returns">
          <h2>Returns</h2>
            <span class="type"><code>GetMetadataOutput</code></span>
            <br>
            A struct containing the output data from the GetMetadata procedure.
            This shall be returned both synchronously on the procedure  call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Metadata: string
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            Metadata: A JSON object containing the metadata from the signals or services in the subtree.
        </section>

        <section id="getmetadata-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Metadata parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>

      </section>

    </section>

    <section id="data-procedures">
      <h2>Data Procedures</h2>
      <p>
      The data procedures provide access to vehicle signals using a "service agnostic" API consisting of the procedures:
      <ul>
        <li>
         Get
        </li>
        <li>
         Set
        </li>
        <li>
         Subscribe
        </li>
        <li>
         Unsubscribe
        </li>
      </ul>
      </p>

      <section id="get-procedure">
        <h2>Get</h2>
        <p>Get the value of one or more signals.</p>

        <p>This procedure retrieves the latest available value with associated timestamp of the signal that is referenced by the input path.
        It is possible to reference multiple signals in one call.<br>
        This procedure supports multiple execution instances.
        </p>

        <section id="get-signature">
          <h2>Signature</h2>
          <pre><code>Get(vehicleId: uint32, path: string, filter: string, stCredentials: string): GetOutput</code></pre>
        </section>

        <section id="get-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>path</strong> (<span class="type">string</span>)
              <br>
              The path must follow the syntax described in HIM. It must address a leaf node in the HIM defined tree, unless there is also an input filter parameter.
            </li>
            <li>
              <strong>filter</strong> (<span class="type">string</span>)
              <br>
              If the path addresses a branch node in the HIM defined tree, then a filter must be used to extend it to one or more leaf nodes.
              The filter expression must follow the syntax as described in the implemented connectivity solution.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
          </ul>
        </section>

        <section id="get-returns">
          <h2>Returns</h2>
            <span class="type"><code>GetOutput</code></span>
            <br>
            A struct containing the output data from the Get procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Data: DataContainer[]
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#data-container">Data: </a>The requested data.
        </section>

        <section id="get-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Data parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="set-procedure">
        <h2>Set</h2>
        <p>Set the value of a signal.</p>

        <p>
        This procedure changes the state of the actuator so that its associated signal becomes set to the value provided.
        This change may be instantaneous or it may take an undefined period of time.
        In the latter case the returned Status only represent the outcome of providing the value to the underlying vehicle system.
        </p>

        <section id="set-signature">
          <h2>Signature</h2>
          <pre><code>Set(vehicleId: uint32, path: string, value: string, stCredentials: string): GeneralOutput</code></pre>
        </section>

        <section id="set-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>path</strong> (<span class="type">string</span>)
              <br>
              The path must follow the syntax described in HIM. It must address a leaf node in the HIM defined tree, unless there is also an input filter parameter.
            </li>
            <li>
              <strong>value</strong> (<span class="type">string</span>)
              <br>
              The value that the signal shall become set to. Regardless of datatype the value is represented in string format.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
          </ul>
        </section>

        <section id="set-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the Set procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>

        <section id="get-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
          </ul>
        </section>
      </section>

      <section id="subscribe-procedure">
        <h2>Subscribe</h2>
        <p>Subscribe to receiving event messages containing one or more signals.</p>

        <p>
        Subscribe initiates a session in which the values of one or more signals are asynchronously returned depending on the event trigger condition.
        It is possible to reference multiple signals in one call.<br>
        The subscription session will continue until either an <a href="#unsubscribe-procedure">Unsubscribe</a> call is issued, or that an error occurs.
        </p>

        <section id="subscribe-signature">
          <h2>Signature</h2>
          <pre><code>Subscribe(vehicleId: uint32, path: string, filter: string, stCredentials: string, callback: *fcn(SubscribeOutput): SubscribeOutput</code></pre>
        </section>

        <section id="subscribe-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a> call.
            </li>
            <li>
              <strong>path</strong> (<span class="type">string</span>)
              <br>
              The path must follow the syntax described in HIM. It must address a leaf node in the HIM defined tree, unless there is also an input filter parameter.
            </li>
            <li>
              <strong>filter</strong> (<span class="type">string</span>)
              <br>
              If the path addresses a branch node in the HIM defined tree, then a filter must be used to extend it to one or more leaf nodes.
              The filter expression must follow the syntax as described in [[VISS]].
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
            <li>
              <strong>callback</strong> (<span class="type">*fcn(SubscribeOutput)</span>)
              <br>
              A pointer to a callback function that is called if an event message gets issued by the service.
              If set to nil callbacks will not be issued.
            </li>
          </ul>
        </section>

        <section id="subscribe-returns">
          <h2>Returns</h2>
            <span class="type"><code>SubscribeOutput</code></span>
            <br>
            A struct containing the output data from the Subscribe procedure.
            This shall be returned both synchronously on the procedure  call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Data: DataContainer[],
              ServiceId: uint32
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#data-container">Data: </a>The requested data.<br>
            ServiceId: A reference to the service session that the client may use to call <a href="#cancel-service-procedure">CancelService</a>.
            It may be set to zero in which case it is invalid.

        </section>

        <section id="subscribe-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Data and ServiceId parameters are invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
      </section>

      <section id="unsubscribe-procedure">
        <h2>Unsubscribe</h2>
        <p>Unsubscribe to an ongoing subscription session.</p>

        <p>This procedure unsubscribes to an ongoing subscription session, leading to the termination of the session.<br>
        This procedure supports multiple execution instances.
        </p>

        <section id="unsubscribe-signature">
          <h2>Signature</h2>
          <pre><code>Unsubscribe(vehicleId: uint32, serviceId: uint32): GeneralOutput</code></pre>
        </section>

        <section id="unsubscribe-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>serviceId</strong> (<span class="type">uint32</span>)
              <br>
              The serviceId was received in the previous Subscribe response.
            </li>
          </ul>
        </section>

        <section id="unsubscribe-returns">
          <h2>Returns</h2>
            <span class="type"><code>GeneralOutput</code></span>
            <br>
            A struct containing the output data from the Unsubscribe procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.
        </section>

        <section id="unsubscribe-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
          </ul>
        </section>
      </section>
    </section>
    </section>
  </section>

  <section id="service-procedures">
    <h2>Service Procedures</h2>
    <p>
    The vehicle services are structured into service groups where each group contains services that relates to a vehicle domain.
    The service groups supported by VAPI are listed below.
    <ul>
      <li>
      <strong><a href="#seating-service-group">Seating</a></strong>
      </li>
      <li>
      <strong><a href="#hvac-service-group">HVAC</a></strong>
      </li>
      <li>
      <strong><a href="#exterior-lighting-service-group">Exterior lighting</a></strong>
      </li>
      <li>
      <strong><a href="#interior-lighting-service-group">Interior lighting</a></strong>
      </li>
    </ul>
    </p>

    <section id="seating-service-group">
      <h2>Seating Service Group</h2>
      <p>
      The seating service group consists of all services related to the vehicle seating.
      </p>

    <section id="get-properties-seating-procedure">
      <h2>GetPropertiesSeating</h2>
        <p>Get the available properties for seating in the vehicle.</p>

        <p>This procedure retrieves the properties related to the seating service group.<br>
        This procedure supports multiple execution instances.
        </p>

        <section id="get-properties-seating-signature">
          <h2>Signature</h2>
          <pre><code>GetPropertiesSeating(vehicleId: uint32): GetPropertiesSeatingOutput</code></pre>
        </section>

        <section id="get-properties-seating-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
          </ul>
        </section>

        <section id="get-properties-seating-returns">
          <h2>Returns</h2>
            <span class="type"><code>GetPropertiesSeatingOutput</code></span>
            <br>
            A struct containing the output data from the GetPropertiesSeating procedure.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Properties: RaggedMatrix
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#ragged-matrix">Properties: </a>A ragged matrix of seat identities and available properties per seat.<br>
        </section>

        <section id="get-properties-seating-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Properties parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
    </section>

    <section id="move-seat-procedure">
      <h2>MoveSeat</h2>
        <p>Performs all supported seat movements.</p>

        <p>
        This procedure performs all supported types of seat movements.
        It supports "synchronous" movement to any position provided as input to the service, 
        and also "asynchronous" movement where the client terminates the service execution by invokation of <a href="#cancel-service-procedure">CancelService</a>.
        In the asynchronous scenario the provided input to the service is typically one of the position range end points (zero or hundred percent).
        Constants are defined to represent movement directions for the different movement types.
        The service will automatically terminate an ongoing callback session when either the vehicle signal representing the movement reaches the
        position provided in the input, or if an error occurs.
        </p>

        <section id="move-seat-signature">
          <h2>Signature</h2>
          <pre><code>MoveSeat(vehicleId: uint32, seatId: MatrixId, movementType: string, position: Percentage,
          stCredentials: string, callback: *fcn(MoveSeatOutput): MoveSeatOutput</code></pre>
        </section>

        <section id="move-seat-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>seatId</strong> (<span class="type"><a href="#matrix-id">MatrixId</a></span>)
              <br>
              The seat Id identifies one of the seats in the vehicle.
            </li>
            <li>
              <strong>movementType</strong> (<span class="type">string</span>)
              <br>
              The seat movement type must be one of the MovementSupport elements retrieved by <a href="#get-properties-seating-procedure">GetPropertiesSeating</a>.
            </li>
            <li>
              <strong>position</strong> (<span class="type"><a href="#percentage">Percentage</a></span>)
              <br>
              The seat movement regardless of type is expressed in a percentage where zero (0) is one end position and hundred (100) is the other end position.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
            <li>
              <strong>callback</strong> (<span class="type">*fcn(MoveSeatOutput)</span>)
              <br>
              A pointer to a callback function that is called if an event message gets issued by the service.
              If set to nil callbacks will not be issued.
            </li>
          </ul>
        </section>

        <section id="move-seat-returns">
          <h2>Returns</h2>
            <span class="type"><code>MoveSeatOutput</code></span>
            <br>
            A struct containing the output data from the MoveSeat procedure.
            This shall be returned both synchronously on the procedure  call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Position: Percentage,
              ServiceId: uint32
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#percentage">Position: </a>The current position of the seat movement.<br>
            ServiceId: A reference to the service session that the client may use to call <a href="#cancel-service-procedure">CancelService</a>.
            It may be set to zero in which case it is invalid.
        </section>

        <section id="move-seat-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Position and ServiceId parameters are invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
    </section>

    <section id="configure-seat-procedure">
      <h2>ConfigureSeat</h2>
        <p>Move a seat to configured positions.</p>

        <p>
        This procedure moves a seat to the configuration defined by each movement type and position in the input.
        Not supported movement ypes in the input will be ignored.
        A client can terminate the service execution by invokation of <a href="#cancel-service-procedure">CancelService</a>.
        The service will automatically terminate an ongoing callback session when either all supported movements reach the
        positions provided in the input, or if an error occurs.
        </p>

        <section id="configure-seat-signature">
          <h2>Signature</h2>
          <pre><code>
          ConfigureSeat(vehicleId: uint32, seatId: MatrixId, configuration: SeatConfig[], stCredentials: string, callback: *fcn(ConfigureSeatOutput): ConfigureSeatOutput
          </code></pre>
        </section>

        <section id="configure-seat-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>seatId</strong> (<span class="type"><a href="#matrix-id">MatrixId</a></span>)
              <br>
              The seat Id identifies one of the seats in the vehicle.
            </li>
            <li>
              <strong>configuration</strong> (<span class="type">SeatConfig array</span>)
              <br>
              Each of the seat configuration <a href="#movement-config">SeatConfig</a> array elements define a movement type and position.
              The sum of all movements position leads to the desired seat configuration.
              If a seat movement type is not supported it is ignored and reported as Unconfigured in the response.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
            <li>
              <strong>callback</strong> (<span class="type">*fcn(ConfigureSeatOutput)</span>)
              <br>
              A pointer to a callback function that is called if an event message gets issued by the service.
              If set to nil callbacks will not be issued.
            </li>
          </ul>
        </section>

        <section id="configure-seat-returns">
          <h2>Returns</h2>
            <span class="type"><code>ConfigureSeatOutput</code></span>
            <br>
            A struct containing the output data from the ConfigureSeat procedure.
            This shall be returned both synchronously on the procedure  call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              Configured: SeatConfig[],
              Unconfigured: string[],
              ServiceId: uint32
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            <a href="#movement-config">Configured: </a>The current positions of the seat movements that were moved by the configuration.<br>
            Unconfigured: If the configuration input contained unsupported movement types then this array contains the names of these.<br>
            ServiceId: A reference to the service session that the client may use to call <a href="#cancel-service-procedure">CancelService</a>.
            It may be set to zero in which case it is invalid.
        </section>

        <section id="configure-seat-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The Configured, Unconfigured and ServiceId parameters are invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
    </section>

    <section id="activate-massage-procedure">
      <h2>ActivateMassage</h2>
        <p>Performs all supported massage types.</p>

        <p>
        This procedure performs all supported types of seat massage.
        It supports time bound set by the duration provided as input to the service.
        The client can at any time terminate the service execution by invokation of <a href="#cancel-service-procedure">CancelService</a>.
        </p>

        <section id="activate-massage-signature">
          <h2>Signature</h2>
          <pre><code>ActivateMassage(vehicleId: uint32, seatId: MatrixId, massageType: string, intensity: Percentage, duration: uint32,
          stCredentials: string, callback: *fcn(MassageOutput): MassageOutput</code></pre>
        </section>

        <section id="activate-massage-parameters">
          <h2>Parameters</h2>
          <ul class="param-list">
            <li>
              <strong>vehicleId</strong> (<span class="type">uint32</span>)
              <br>
              A reference to the vehicle that was obtained in a previous <a href="#getvehicle-procedure">GetVehicle</a>.
            </li>
            <li>
              <strong>seatId</strong> (<span class="type"><a href="#matrix-id">MatrixId</a></span>)
              <br>
              The seat Id identifies one of the seats in the vehicle.
            </li>
            <li>
              <strong>massageType</strong> (<span class="type">string</span>)
              <br>
              The massage type type must be one of the MassageSupport elements retrieved by <a href="#get-properties-seating-procedure">GetPropertiesSeating</a>.
            </li>
            <li>
              <strong>intensity</strong> (<span class="type"><a href="#percentage">Percentage</a></span>)
              <br>
              The massage intensity is expressed in a percentage where zero (0) is the minimum level and hundred (100) is the maximum level.
            </li>
            <li>
              <strong>duration</strong> (<span class="type">uint32</span>)
              <br>
              The massage duration is expressed in seconds. It is limited to a maximum duration of 24 hours.
              If set to zero then the duration becomes set to 24 hours.
            </li>
            <li>
              <strong>stCredentials</strong> (<span class="type">string</span>)
              <br>
              The short term credentials that was obtained by a call to <a href="#get-st-credentials-procedure">GetStCredentials</a>.
            </li>
            <li>
              <strong>callback</strong> (<span class="type">*fcn(MassageOutput)</span>)
              <br>
              A pointer to a callback function that is called if an event message gets issued by the service.
              If set to nil callbacks will not be issued.
            </li>
          </ul>
        </section>

        <section id="activate-massage-returns">
          <h2>Returns</h2>
            <span class="type"><code>MassageOutput</code></span>
            <br>
            A struct containing the output data from the ActivateMassage procedure.
            This shall be returned both synchronously on the procedure  call and asynchronously on event trigger conditions.
            <pre><code>
            {
              Status: ProcedureStatus,
              Error: *ErrorData,
              ServiceId: uint32
            }
            </code></pre>
            Struct member descriptions:<br>
            <a href="#procedure-status">Status: </a>The status of the latest service call to it.<br>
            <a href="#error-data">Error: </a>Error information for the latest service call, if error occurred.<br>
            ServiceId: A reference to the service session that the client may use to call <a href="#cancel-service-procedure">CancelService</a>.
            It may be set to zero in which case it is invalid.
        </section>

        <section id="activate-massage-error">
          <h2>Error</h2>
          <ul class="error-list">
            <li>
            If Status is set to FAILED then Error must be available and populated with error data, else the pointer to Error shall be set to nil.
            </li>
            <li>
            Error data shall conform to the error data definitions in [[VISS]] for signals.
            </li>
            <li>
             The ServiceId parameter is invalid if Status is set to FAILED.
            </li>
          </ul>
        </section>
    </section>
  </section>

  <section id="hvac-service-group">
    <h2>HVAC Service Group</h2>
    <p>
      The HVAC service group consists of all services related to the vehicle HVAC functionality.
    </p>

    <section id="xxx-procedure">
      <h2>xxx Procedure</h2>
      <p>
      xxx
      </p>
    </section>
  </section>

  <section id="exterior-lighting-service-group">
    <h2>Exterior Lighting Service Group</h2>
    <p>
      The Exterior lighting service group consists of all services related to the vehicle exterior lighting.
    </p>

    <section id="xxx-procedure">
      <h2>xxx Procedure</h2>
      <p>
      xxx
      </p>
    </section>
  </section>

  <section id="interior-lighting-service-group">
    <h2>Interior Lighting Service Group</h2>
    <p>
      The Interior lighting service group consists of all services related to the vehicle interior lighting.
    </p>

    <section id="xxx-procedure">
      <h2>xxx Procedure</h2>
      <p>
      xxx
      </p>
    </section>
  </section>
  </section>

  <section id="datatype-definitions">
    <h2>Datatype Definitions</h2>
    <p>
    Datatypes that are used by multiple procedures are defined below.
    </p>

      <section id="error-data">
        <h2>ErrorData</h2>
        A struct containing the error data related to a failed procedure call.<br>
        The Code shall conform to the status codes defined in [[RFC2616]].<br>
        The Reason shall be the associated reason phrase from the referenced RFC document.<br>
        The Description shall provide more context of the failure.
        <pre><code>
        struct {
            Code: int32,
            Reason: string,
            Description: string
        }
        </code></pre>
      </section>

      <section id="data-container">
        <h2>DataContainer</h2>
        A struct containing the path of a signal and one or more data points of the signal.
        <pre><code>
        struct {
            Path: string,
            SignalData: DataPoint[]
        }
        </code></pre>
      </section>

      <section id="data-point">
        <h2>DataPoint</h2>
        A struct containing one data point. A data point contains a signal value and its associated timestamp.
        The value has string format which is used to represent the value for any of the datatypes supported by HIM.
        <pre><code>
        struct {
            Value: string,
            Timestamp: string
        }
        </code></pre>
      </section>

      <section id="procedure-status">
        <h2>ProcedureStatus</h2>
        An enumeration of int8 values representing the current state of a procedure execution. If set to FAILED then associated ErrorData is available.
        <pre><code>
        enum: [
            ONGOING = 1,     // in execution of latest call
            SUCCESSFUL = 0,  // terminated successfully in latest call
            FAILED = -1      // terminated due to failure in latest call
        ]
        </code></pre>
      </section>
 
      <section id="supported-protocol">
        <h2>Supported protocols</h2>
        A string array containing names of the supported protocols. The first on the list is set as default,
        which can be changed by <a href="#select-protocol-procedure">SelectProtocol</a> if multiple protocolsa are supported.
        Protocol naming should be "MainProtocolName-SubProtocolName", e. g. "VISSv3.0-grpc".
      </section>
 
      <section id="percentage">
        <h2>Percentage</h2>
        A float value ranging from zero to one hundred.
        This represents the percentage of the current value within a range calculated as current value / (max range value - min range value).
        The semantics of max and min range values shall be defined in the context of the range being addressed.
        <pre><code>
        float
        min = 0
        max = 100
        </code></pre>
      </section>

      <section id="matrix-id">
        <h2>MatrixId</h2>
        A struct containing the Id of one element of a two-dimensional matrix.
        <pre><code>
        struct {
            RowName: string,
            ColumnName: string
        }
        </code></pre>
      </section>

      <section id="ragged-matrix">
        <h2>RaggedMatrix</h2>
        A two-dimensional matrix in which the number of elements may vary in the different rows.
        The matrix is represented as an array of RowDef elements.
        The Rowdef datatype is a struct with one element representing the name of the row,
        and the other is a string array containing the elements of that row,
        each containing the column name and the available properties.
        <pre><code>
        SupportData: struct {
            Name: string,
            Description: string
        }

        ColumnData: struct {
            Name: string,
            MovementSupport: SupportData[],
            MassageSupport: SupportData[]
        }

        RowDef: struct {
        {
            RowName: string,
            Column: ColumnData[]
        }

        RaggedMatrix: RowDef[]
        </code></pre>
      </section>

      <section id="seat-movement">
        <h2>SeatMovementType</h2>
        A struct containing the name and description of seat movement types in the vehicle.
        <pre><code>
        struct {
            Name: string,
            Description: string
        }
        </code></pre>
        If any of the following types of movement are supported then these names and descriptions should be used.
          <ul>
            <li>
              <strong>longitudal:</strong>
              Seat movement in the direction parallel to the driving direction.
              Forward/backward movements with max backwards being zero percentage.
            </li>
            <li>
              <strong>vertical:</strong>
              Seat movement in the vertical direction to the driving plane.
              Up/down movements with max down being zero percentage.
            </li>
            <li>
              <strong>tilt:</strong>
              Angular seat movement of the backrest relative the driving plane.
              Tilt/recline movements with max recline being zero percentage.
            </li>
            <li>
              <strong>lumbar:</strong>
              Seat movement of the lumber support.
              Inflate/deflate movements with max deflate being zero percentage.
            </li>
            <li>
              <strong>headrest-vertical:</strong>
              Seat headrest movement the vertical direction to the driving plane.
              Up/down movements with max down being zero percentage.
            </li>
            <li>
              <strong>headrest-tilt:</strong>
              Angular movement of the seat headrest relative to the driving plane.
              Tilt/recline movements with max recline being zero percentage.
            </li>
          </ul>
          Movement types not covered by the list may be added in an implementation.
      </section>

      <section id="movement-config">
        <h2>SeatConfig</h2>
        A struct containing a seat movement type and the position it should be moved to.
        <pre><code>
        struct {
            MovementType: string,
            Position: Percentage
        }
      </section>

      <section id="service-signature">
        <h2>ServiceSignature</h2>
        A struct describing the procedure signature of an auxillary service.<br>
        The Name member shall be used as the serviceName input parameter when calling <a href="#invoke-procedure">Invoke</a> to perform a call of this service.<br>
        The Input member is a JSON object describing the input parameters of the auxillary service.
        The format described shall be used procedureInput input parameter in the Invoke call.<br>
        The Output member is a JSON object describing the output parameters of the auxillary service.
        This can be helpful when decoding the JSON object that is received in the response (and events if issued) from the service call.
        <pre><code>
        struct {
            Name: string,
            Input: string,
            Output: string
        }
        </code></pre>
      </section>

    </section>

    <section id="constant-definition">
      <h2>Constants</h2>

      <section id="movement-types">
        <h2>Movement Types</h2>
        <pre><code>
	const (
		LONGITUDINAL = "longitudinal" //Forward-backward direction of the vehicle
		VERTICAL = "vertical"         // Up-down direction of the vehicle
		BACKREST = "backrest"         // Seat backrest angular
		LUMBAR = "lumbar"             // Seat inflate-deflate lumbar
	)
        </code></pre>
      </section>

      <section id="movement-directions">
        <h2>Movement Directions</h2>
        <pre><code>
	const (
		FORWARD = 0            //longitudinal movement
		BACKWARD = 100         //longitudinal movement
		UP = 100               //vertical movement
		DOWN = 0               //vertical movement
		INFLATE = 100          //lumbar movement
		DEFLATE = 0            //lumbar movement
		FORWARD_RECLINE = 0    //backrest movement
		BACKWARD_RECLINE = 100 //backrest movement
	)
        </code></pre>
      </section>

    </section>
  </body>
</html>
